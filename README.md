# Project_CS.7389F_Cyber_security_Class
The code for the project of cyber security class CS.7389F in TXST. The project evaluate the performance of two deepfake models on images generated by the InstantID model. 

# Requeriements
The repositorty is composed by three subrepository:
* InstantID - Link: https://github.com/instantX-research/InstantID 
* AIGCDetectBenchmark - Link: https://github.com/Ekko-zn/AIGCDetectBenchmark/tree/main  
* UniversalFakeDetect - Link: https://github.com/ZhendongWang6/DIRE?tab=readme-ov-file

Each repositoty has their own requeirmenet specified in the respective README.md


# Image generation
The image generation was based to the dataset LPFF-dataset (https://github.com/oneThousand1000/LPFF-dataset/tree/master). 
In the project we used 1000 images located in the folder dataset.
The images was generated using the script : 

    InstantID/infer_fake.py 

### Steps:
 * Place the images under a folder called  'real_dataset' in the folder InstantID
 * Run:

    `python infer_fake.py`

# AIGCDetectBenchmark
The  code was ran using the command:

    `python eval_all.py --model_path models/CNNSpot.pth --detect_method CNNSpot  --noise_type blur --blur_sig 1.0 --no_resize --no_crop --batch_size 5`

# UniversalFakeDetect
The  code was ran using the command:

    `python validate.py  --arch=CLIP:ViT-L/14   --ckpt=pretrained_weights/fc_weights.pth   --result_folder=clip_vitl14  --real_path Data_InstantID/ --fake_path poseMona/  --data_mode 'ours' --batch_size 10`

# Results 
The results of model is available on file results_analyses.ipynb


# References:

LPFF-dataset
```bibtex
@InProceedings{Wu_2023_ICCV,
    author    = {Wu, Yiqian and Zhang, Jing and Fu, Hongbo and Jin, Xiaogang},
    title     = {LPFF: A Portrait Dataset for Face Generators Across Large Poses},
    booktitle = {Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV)},
    month     = {October},
    year      = {2023},
    pages     = {20327-20337}
}
```

InstantID
```bibtex
@article{wang2024instantid,
title={InstantID: Zero-shot Identity-Preserving Generation in Seconds},
author={Wang, Qixun and Bai, Xu and Wang, Haofan and Qin, Zekui and Chen, Anthony},
journal={arXiv preprint arXiv:2401.07519},
year={2024}
}
```

AIGCDetectBenchmark
```bibtex
@article{zhong2023patchcraft,
title={Patchcraft: Exploring texture patch for efficient ai-generated image detection},
author={Zhong, Nan and Xu, Yiran and Li, Sheng and Qian, Zhenxing and Zhang, Xinpeng},
journal={arXiv preprint arXiv:2311.12397},
year={2023}
}
```

UniversalFakeDetect
```bibtex
@article{wang2023dire,
title={DIRE for Diffusion-Generated Image Detection},
author={Wang, Zhendong and Bao, Jianmin and Zhou, Wengang and Wang, Weilun and Hu, Hezhen and Chen, Hong and Li, Houqiang},
journal={arXiv preprint arXiv:2303.09295},
year={2023}
}
```